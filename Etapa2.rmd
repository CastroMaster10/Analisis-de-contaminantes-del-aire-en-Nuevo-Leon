---
title: "Tecnológico de Monterrey"
date: "18 de Agosto de 2023"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


**Aplicación de métodos multivariados en ciencia de datos**

MA2003B.101

# **Conocimiento de la naturaleza de contaminantes que influyen en la calidad del aire y sus interrelaciones con el medio**

**Profesoras**

### Monica Guadalupe Elizondo Amaya

### Blanca Rosa Ruiz Hernandez

**Autores**

**(Equipo 6)**

Rubén Darío Castro Terrazas (A00833945)

Christian Jaffe Alarcón Acosta (A00832881)

José Andrés Orantes Guillén (A01174130)

Juan José Montes Raygoza (A00834630)

Pedro Fernández Merino (A01733006)

# Importar librerias y dependencias

```{r warning =FALSE,echo=FALSE}
library(readxl)
library(Hmisc)
library(gridExtra)
library(ggplot2)
library(corrplot)
library(dplyr)
library(outliers)
```


# Etapa I

La problemática de la contaminación del aire se ha erigido como un tema de suma importancia en la agenda global, debido a sus profundos impactos en la salud humana, el entorno ambiental y el fenómeno del cambio climático. La calidad del aire se refiere a la composición y pureza de los gases que conforman la atmósfera que respiramos. Esta contaminación puede originarse de diversas fuentes, tales como la quema de combustibles fósiles, las emisiones industriales, el tráfico vehicular y las prácticas agrícolas. En el contexto específico de Nuevo León y su zona metropolitana, estas cuatro actividades ejercen un notorio impacto.

A medida que estas fuentes emiten contaminantes al aire, sus efectos pueden acarrear consecuencias graves para la sociedad y el planeta en su conjunto. De acuerdo con la Organización Mundial de la Salud, la contaminación del aire representa uno de los principales riesgos ambientales para la salud, desencadenando una carga significativa de enfermedades como accidentes cerebrovasculares, enfermedades cardíacas, cáncer de pulmón y diversas afecciones pulmonares crónicas y agudas, incluyendo el asma. De hecho, estas enfermedades se asocian con un número anual alarmante de 6.7 millones de muertes prematuras [1].

Por otra parte, estadísticas proporcionadas por la National Weather Service han calculado que los costos económicos relacionados con esta contaminación ascienden a 150 mil millones de dólares anuales, únicamente en los Estados Unidos [2]. De esta manera, resulta claro que por el bienestar de la economía y, lo que es aún más primordial, por la preservación de nuestra salud, se torna imperativo salvaguardar la calidad del aire que nos rodea.

Es fundamental comprender los aspectos cruciales que se consideran al analizar la calidad del aire y familiarizarse con las clasificaciones internacionales de los contaminantes más relevantes, así como identificar los contaminantes más perjudiciales para la salud. Esta información enriquecerá considerablemente el contenido de este informe. Entre los aspectos esenciales para evaluar la calidad del aire se destacan:

§**Partículas en suspensión (PM2.5 y PM10):** Estas partículas diminutas suspendidas en el aire tienen un impacto significativo en la salud. Las PM2.5 son aquellas con un diámetro igual o menor a 2.5 micrómetros, mientras que las PM10 tienen un diámetro igual o menor a 10 micrómetros [3].

§**Niveles elevados de ozono (O3):** Cuando el ozono, un compuesto que nos protege de los rayos ultravioleta en la estratósfera, desciende a niveles del suelo, provoca contaminación atmosférica perjudicial, conocida como "smog" en inglés. Esto tiene consecuencias negativas para la salud comunitaria [4].

§ **Dióxido de nitrógeno:** Este gas contribuye a la formación del "smog" y está relacionado con problemas de salud como afecciones respiratorias.

§ **Dióxido de azufre:** Principalmente emitido por la quema de combustibles fósiles, este compuesto puede dar lugar a la lluvia ácida y otros impactos ambientales [5].

§ **Plomo:** El plomo representa una preocupación mayor debido a sus graves efectos en la salud y desarrollo humano. Estudios, como los citados en un artículo de The Atlantic, han demostrado una relación directa entre la exposición al plomo y la disminución del coeficiente intelectual, daños auditivos, habilidades cognitivas debilitadas e incluso tasas más altas de criminalidad en diferentes estados [6]. En el siglo XX, el plomo desempeñó un papel determinante en el deterioro del desarrollo infantil en Estados Unidos, lo que resalta su impacto negativo en la sociedad.

Es crucial comprender cómo se mide la calidad del aire, qué variables intervienen en este proceso y cómo se llevan a cabo las mediciones. Para llevar a cabo la medición de la calidad del aire, se emplean sistemas de vigilancia equipados con sensores diseñados específicamente para detectar contaminantes particulares. Estos contaminantes pueden originarse tanto de fuentes naturales, como tormentas de polvo, humo de incendios forestales y erupciones volcánicas, como de fuentes antropogénicas, como la quema de combustibles fósiles [7].

Dentro del conjunto de contaminantes mencionados previamente, existen algunos que tienen impactos significativos en la salud humana y el medio ambiente. Entre estos se encuentran PM2.5, PM10, ozono troposférico, dióxido de carbono, dióxido de nitrógeno y dióxido de azufre [8]. La presencia y concentración de estos contaminantes en el aire se traducen en el Índice de Calidad del Aire (ICA), cuyo rango va desde 0 hasta 500. En este índice, un puntaje de 50 o menos se considera seguro, mientras que valores superiores a 100 indican niveles poco saludables [9]

Sin embargo, la evaluación de la calidad del aire no se limita únicamente a los contaminantes presentes en el aire en un momento determinado. Las estaciones meteorológicas también incorporan variables como la dirección y velocidad del viento, la humedad relativa, la temperatura, la precipitación, la presión atmosférica y la radiación solar en su análisis. Estos factores meteorológicos juegan un papel crucial en la dispersión y concentración de los contaminantes, así como en la formación de patrones de contaminación.

Esta comprensión integral de la medición de la calidad del aire nos brinda una perspectiva más completa sobre cómo se evalúa y monitorea esta cuestión crítica, en concordancia con la información previamente proporcionada.

§ **Cuáles son las normas oficiales establecidas de los distintos contaminantes para la protección de la salud.**

Las normas oficiales establecidas de los contaminantes para la protección de la salud son las siguientes:


| **Contaminante**|-| **Norma** | **Concentración** | **Tiempo de exposición(horas)** |
| --- | --- | --- | --- | --- |
| Monóxido de Carbono | CO | NOM-021-SSAI-2021 | 26.00 ppm | 1 |
| Monóxido de Carbono | CO | NOM-021-SSAI-2021 | 9.0 ppm | 8 |
| Bióxido de Azufre | SO2 | NOM-022-SSAI-2019 | 0.075 ppm | 1 |
| Bióxido de Azufre | SO2 | NOM-022-SSAI-2019 | 0.04 ppm | 24 |
| Ozono | O3 | NOM-020-SSAI-2021 | 0.090 ppm | 1 |
| Ozono | O3 | NOM-020-SSAI-2021 | 0.065 ppm | 8 |
| Bióxido de Nitrógeno | NO2 | NOM-023-SSAI-2021 | 0.106 ppm | 1 |
| Bióxido de Nitrógeno | NO2 | NOM-023-SSAI-2021 | 0.021 ppm | Promedio Anual |
| Partículas Menores a 10 micras | PM10 | NOM-025-SSAI-2021 | 70 µg/m3 | 24 |
| Partículas Menores a 10 micras | PM10 | NOM-025-SSAI-2021 | 36 µg/m3 | Promedio Anual |
| Partículas Menores a 2.5 micras | PM2.5 | NOM-025-SSAI-2021 | 41 µg/m3 | 24 |
| Partículas Menores a 2.5 micras | PM2.5 | NOM-025-SSAI-2021 | 10 µg/m3 | Promedio Anual |

**Tabla 1. Normas Oficiales, obtenida de: Aire Nuevo León**

En estas normas se establecen los criterios a tomar en cuenta para evaluar la calidad del aire, con respecto a la concentración de cada contaminante.

La medición de la calidad del aire se encuentra confrontada con desafíos considerables debido a una serie de factores complejos. La falta de estandarización en los métodos de medición, la variabilidad en distintos lugares y momentos, y la complejidad inherente de los contaminantes y sus impactos en la salud humana se perfilan como obstáculos centrales [10].

La falta de uniformidad en los enfoques de medición dificulta la comparación y evaluación de datos, lo que a su vez complica la toma de decisiones informadas. La variabilidad en la calidad del aire, impulsada por diversas fuentes de contaminación, condiciones climáticas cambiantes y características topográficas, plantea dificultades para obtener mediciones verdaderamente precisas. Además, la amplia gama de contaminantes y sus efectos multifacéticos en la salud requieren la implementación de equipos y metodologías especializadas [10].

Un factor adicional que contribuye a los desafíos es la falta de requisitos legales para la medición de la calidad del aire en un considerable 37% de los países, según datos del Programa de las Naciones Unidas para el Medio Ambiente (PNUMA). Esta carencia limita la disponibilidad de datos confiables y obstaculiza la formulación de políticas efectivas para controlar la contaminación del aire y salvaguardar la salud pública [11]. En resumen, la superación de estas dificultades es de vital importancia para comprender plenamente y mitigar los riesgos asociados con la contaminación del aire.

**Socio Formador**

En México, se han establecido los programas ProAire para abordar las necesidades de los estados en cuanto a contar con herramientas preventivas y correctivas en relación con la calidad del aire y la protección de la salud [12]. Un ejemplo de ello es el programa SIMA en el Estado de Nuevo León, que representa el Sistema Integral de Monitoreo Ambiental. En este proyecto, SIMA desempeña un papel fundamental como socio formador en el proyecto actual, trabajando conjuntamente para lograr los objetivos que se describen a continuación.

El programa SIMA es una iniciativa respaldada por el Gobierno del Estado de Nuevo León, cuyo propósito central radica en evaluar la calidad del aire mediante la monitorización de las concentraciones atmosféricas a las que está expuesta la población. Específicamente, en situaciones adversas, el programa tiene la función de alertar a la población sobre episodios en los que los niveles de contaminación atmosférica son elevados [13].

Una de las características destacadas de este programa es su capacidad para suministrar información actualizada de manera constante acerca de la calidad del aire en la región donde opera. Su ámbito de actuación principal abarca la zona metropolitana de Monterrey. La entidad responsable de la gestión de este programa es la Secretaría de Medio Ambiente.

·**Descripción del problema específico (preguntas de investigación)**

El problema es la contaminación del aire producida por diferentes contaminantes en el estado de Nuevo León y diferentes cuestiones climatológicas, por eso se abordarán las siguientes preguntas de investigación para enfocarnos en el problema específico:

- ¿Hay una relación entre los contaminantes que tenga un impacto significativo en la calidad del aire?
- ¿La calidad del aire se ve afectada por una relación entre las cuestiones climatológicas y los contaminantes?
- ¿Qué tanto se ve afectada la calidad del aire con relación a la concentración de cada contaminante?

·**Objetivos (se definen con base en las preguntas de investigación)**

**Pregunta 1:**

1. **Objetivo General:** Identificar si existen relaciones entre los contaminantes atmosféricos que se encuentran en la base de datos y a su vez determinar si estas relaciones tienen un impacto importante en la calidad del aire.
2. **Objetivos Específicos:**
  1. Analizar el impacto de cada contaminante en la calidad del aire.
  2. Identificar patrones de comportamiento temporales en los contaminantes y su impacto en la calidad del aire.
  3. Comparar el impacto de los contaminantes en la calidad del aire.

**Pregunta 2:**

1. **Objetivo General:** Observar la relación entre las variables climatológicas y las variables contaminantes para determinar el impacto de esta relación en la calidad del aire.
2. **Objetivos Específicos:**
  1. Analizar el impacto de las variables climatológicas en la calidad del aire.
  2. Realizar el análisis de la relación entre las variables climatológicas y las contaminantes.
  3. Evaluar de qué forma varía el impacto de las variables climatológicas y contaminantes en la calidad del aire, debido a la variación geográfica.
  4. Identificar patrones de comportamiento temporales en la relación entre las variables climatológicas y contaminantes.

**Pregunta 3:**

1. **Objetivo General:** Determinar el impacto de diferentes niveles de concentración de contaminantes atmosféricos en la calidad del aire, y en la salud humana y ambiental.
2. **Objetivos Específicos:**
  1. Indagar sobre el impacto de los contaminantes en la salud humana y ambiental, y definir rangos aceptables para cada contaminante.
  2. Comparar el impacto que tiene cada contaminante en la calidad del aire.
  3. Verificar si existen variaciones entre los niveles de contaminantes y la calidad del aire dadas por variación geográfica.
  4. Elaborar una serie de recomendaciones y medidas de prevención en base a los resultados que se obtengan.

· **Justificación de los objetivos**

La contaminación es un problema que no se puede dejar de abordar, especialmente cuando cada vez nos acercamos más al año 2030, en el cual deberíamos tener cumplidos varios ODS. En el estado de Nuevo León el principal problema de contaminación, de acuerdo a la ciudadanía, es el aire [14], por lo que resulta de interés hacer un análisis que permita encontrar información que ayude de alguna manera a disminuir este problema. A continuación se presentan las razones para la realización de este trabajo y sus objetivos:

1. **Impacto en la Salud de la Población:** La comprensión de las relaciones entre los contaminantes y la calidad del aire permitirá impactar en gran medida la salud de la población, pues podrá servir para saber hacia dónde dirigir las políticas que buscan la reducción de esta contaminación.
2. **Variabilidad climática:** El análisis de la relación entre las variables climatológicas y contaminantes, permitirá comprender cómo su relación tiene un impacto en la calidad del aire y, a su vez, en la salud humana. La comprensión de esta relación permitirá la toma de decisiones relacionadas con la prevención de problemas de salud de los ciudadanos.
3. **Evaluación e identificación de contaminantes que presentan mayor riesgo para la salud:** El conocimiento de la concentración de los contaminantes en el aire permitirá conocer el daño potencial que presentan para los habitantes del estado. Teniendo en cuenta esto, se podrá realizar la identificación de contaminantes que presenta mayor riesgo, y se podrá buscar una manera en la que se pueda mitigar la emisión de estos contaminantes.
4. **Toma de Decisiones guiada por la información obtenida:** El análisis de esta información permitirá que se puedan tomar decisiones que lleven a la mitigación del problema. Además que con estos datos se podrán planificar nuevas estrategias y políticas, generales y específicas, que permitan la prevención del aumento de la contaminación y un aumento en la afectación de la salud de los ciudadanos y del medio ambiente.

·**Descripción de las fuentes de información (datos)**

Las fuentes de información que han sido utilizadas para la realización de este trabajo hasta el momento son principalmente gubernamentales, puesto que buscamos entregar un trabajo que se sustente de fuentes que a la consideración del equipo se consideren confiables, no olvidando que se quiere primeramente tomar fuentes primarias o secundarias. Algunas de estas fuentes son la Organización Mundial de la Salud, el Servicio Nacional del Clima de Estados Unidos, las Naciones Unidas, y el gobierno de Nuevo León a través del SIMA.

Para realizar el trabajo estadístico que se presentará a continuación se hará uso de una base de datos proporcionada por el Sistema Integral de Monitoreo Ambiental de Nuevo León. Estos datos se encuentran divididos por estaciones de monitoreo, que se pueden encontrar en la página de SIMA en tiempo real. Los datos que se recopilaron son de contaminantes presentes en el aire en ciertas horas y fechas, además que son de igual manera de carácter climatológico.


· **Impacto social principal**

Se espera que el desarrollo del proyecto tenga un impacto positivo para la sociedad a través de la generación de conocimiento e información que permita la generación de planes de mitigación para el problema actual que resulta ser actualmente la contaminación del aire. Estos planes de mitigación se espera que aporten un gran beneficio a la población en general. Además de los planes de mitigación se espera que se puedan generar políticas para problemas específicos que se puedan encontrar a través de la información generada.


# Etapa II: Comprensión y preparación de los datos

Para dirigir la solución al reto, seguirás la metodología CRISP-DM. En esta primera actividad realizarás el segundo paso Comprensión y Preparación de los datos que permitirá añadir el análisis descriptivo e introductorio de las variables.

## 1) Comprensión de los datos del negocio

### Importar base de datos

```{r warning=FALSE}
sheet_names = excel_sheets("datos2022_2023_estaciones.xlsx")

for (i in 1:length(sheet_names)) {
  variable_name = paste("M",sheet_names[i],sep="_")
  value = read_excel("datos2022_2023_estaciones.xlsx",sheet = sheet_names[i])
  assign(variable_name,value) #guardamos cada hoja en una variable
}
```

Lo que se hizo en el código de arriba fue guardar los datos de cada estación en una variable. Por fines prácticos utilizaremos solamente una de ellas para realizar el análisis descriptivo de esta entrega.

### A Dimensión del dataset

```{r}
cat("Número de observaciones:",dim(M_CENTRO)[1])
cat("\nNúmero de variables:",dim(M_CENTRO)[2])
```
### Describe claramente cada una de las variables, incluyendo su nombre, descripción, tipo (categórico/Numérico) y valores posibles que puede tomar, valores nulos.

```{r}
cat("Tipo dato de cada variable\n")
t(sapply(M_CENTRO,class))
```
```{r}
summary(M_CENTRO)
```
Si observamos a simple vista la tabla hecha por la función summary(), inicialmente vemos que las variables que deberían catalogarse como cuantitativas se identifican como carateres, lo cual no resulta eficiente para hacer un analisis estadistico y descriptivo. Para solucionar esto, transformaremos los datos de las variables para que sean numéricos.

### Transformación a variables numéricas

```{r warning=FALSE}
variables_names = colnames(M_CENTRO)
M_CENTRO[,2:length(variables_names)] = sapply(M_CENTRO[,2:length(variables_names)],as.numeric)
t(sapply(M_CENTRO,class))
```
```{r}
cat("Valores únicos por cada variable\n")
for (i in 1:length(variables_names)) {
cat("\n-",variables_names[i],":",length(unique(sapply(M_CENTRO [,i],as.list)))) #Transformamos las columnas a vectores para poder calcular sus valores únicos
}
```

```{r}
cat("\nNúmero de valores nulos (NA) por variable")
for (i in 1:length(variables_names)){
  cat(cat("\n-",variables_names[i],":",length(which(is.na(M_CENTRO[,i]),arr.ind=TRUE))))
}
```


### Exploración de los datos

1. Variables cuantitativas

   - Medidas de posición no-central: cuartiles, outlier (valores atípicos), boxplots
   
```{r}
summary(M_CENTRO)
```
```{r}
#Desviacion estandar por variable
cat("Desviacion estandar por variable")
for (i in 1:length(variables_names)) {
cat(cat("\n-",variables_names[i],":",sapply(M_CENTRO[,i],var))) #omitimos los valores faltantes
}
```
Vemos que obtenemos "NA"s o "valores faltantes" cuando tratamos de obtener la desviación estándar de cada variable-a excepción de la variable de fecha ya que esa es categórica y no aporta valor al análisis. Esto se debe principalmente a que R no acepta valores faltantes al calcular la desviación estandar o la varianza por cada columna. Mucho del análisis requiere que no haya valores faltantes, por lo que tendremos que omitir estos los datos faltantes.



```{r}
#Desviacion estandar por variable
cat("Desviacion estandar por variable")
for (i in 1:length(variables_names)) {
cat(cat("\n-",variables_names[i],":",sapply(na.omit(M_CENTRO[,i]),var)))
}
```


   - Análisis de distribución de los datos (Histogramas). Identificar si tiene forma simétrica o asimétrica

```{r}
#Histograma
list <-lapply(1:ncol(M_CENTRO),
              function(col) ggplot2::qplot(M_CENTRO[[col]],
                                           geom = "histogram",
                                           binwidth = 1))

cowplot::plot_grid(plotlist = list)
```

A simple vista, podemos deducir que la mayoría de las variables cauntitativas tienen un sesgo hacia la derecha, a excepción de variables como "PRS","RH",y "TOUT".

```{r}
par(mfrow = c(2, 4)) #Despliega los boxplot en una sola hoja
for (col in variables_names) {
  boxplot(na.omit(M_CENTRO[[col]]), main = col)
}
```


   - Análisis de correlación  de los datos, mapa de calor
   
```{r}
cor_matrix = cor(na.omit(M_CENTRO[,2:length(variables_names)]))
cor_matrix
```

```{r}
# Visualiza la matriz de correlación utilizando corrplot
corrplot(cor_matrix, method = "circle")
```
Visualmente, se observan los siguientes aspectos:

* Las variables NO y NOX parecen tener una correlación positiva fuerte
* Las variables TOUT y PRS parecen tener una correlación negativa fuerte
* NO y NO2 parecen tener una correlación positiva fuerte o moderada
* La variable O3 parece ser que tiene correlaciones moderadas con NO,NO2, NOX,SR,TOUT,WSR
* La variable WSR tiene correlaciones débiles o moderadas con NO,NO2 Y NOX
* Las variables PM10 Y PM2.5 parecen tener correlaciones moderadas con NO,NO2 y NOX
* La variable RAINF no tiene ninguna relación con ninguna otra variable

Se encuentran varios patrones dentro de los datos, sin embargo, resulta central realizar pruebas de *independencia* y de *colinealidad* entre nuestras posibles variables predictoras para poder reducir la dimensionalidad de nuestra matríz de datos y la complejidad del problema. Del mismo modo, nuestras variables de interés o dependientes tendrán que ser los contaminantes que describimos en la etapa I-estos incluyen a "O3", "PM10","PM2.5" o "NO"
   
2. Variables categóricas
   - Distribución de los datos (diagramas de barras, diagramas de pastel)
   
   En este caso nadamas tenemos una variable categórica, la cual el la variable "date", por lo que no tiene mucho caso analizar esta misma

### Verificación de datos

1. Valores faltantes

Como ya se vió anteriormente, se necesitan eliminar a los valores faltantes y en el proceso de hacerlo, tenemos que asegurarnos de no haber perdido tanta información. Para esto necesitamos ver que porcentaje de los datos totales son "NA".

```{r}
cat("\nNúmero de valores nulos (NA) por variable")
props_NA = c()
for (i in 1:length(variables_names)){
  prop = length(which(is.na(M_CENTRO[,i]),arr.ind=TRUE)) / nrow(M_CENTRO)
  cat("\n-",variables_names[i],":",prop)
  props_NA[length(props_NA) + 1] = prop
}

plot(1:length(variables_names),props_NA,col="blue",xlab="Variables",ylab="Porcentaje",main="Porcentaje de Valores faltantes")
abline(h=mean(props_NA ),col="red")  #media de valores faltantes
```

Vemos que el mayor porcentaje que representan los datos faltantes es de `r mean(props_NA) * 100`%, y el máximo de ellos siendo el de la variable "PM2.5", "so2" y "NO",respectivamente. No hay un estandar que diga a que porcentaje es seguro eliminar los valores faltantes sin perder una gran cantidad de información; sin embargo, como en este caso tenemos un gran número de valores válidos con respecto a los inválidos, tomaremos la decisión empírica de eliminarlos

```{r}
#Tratamiento de valores faltantes
M_CENTRO = na.exclude(M_CENTRO)
cat("\nNúmero de valores nulos (NA) por variable")
for (i in 1:length(variables_names)){
  cat(cat("\n-",variables_names[i],":",length(which(is.na(M_CENTRO[,i]),arr.ind=TRUE))))
}
```

2. Valores de los datos

```{r}
summary(M_CENTRO)
```

## Preparación de los datos

### 1) Selecciona el conjunto de datos a utilizar


a) Decide qué conjunto de datos se utilizará. Explica por qué se incluyeron o excluyeron ciertos datos.

Para este caso en particular utilizaremos nos quedaremos con el siguientes listado de variables predictoras:

* N0
* N02
* N0X
* RH
* SR
* TOUT
* WSR

Las variables anteriores fueron seleccionadas en base al mapa de calor anterior donde muestra las matríz de correlaciones, y donde se visualiza la maginitud de las correlaciones.Además, se eligieron ese conjunto de contaminantes y variables metereologicas con fines de predecir los niveles de O3, PM2.5 Y PM10. No obstante, quedará pendiente realizar una prueba de independencia entre las variables.

```{r}
selected_names = c("NO","NO2","NOX","RH","SR","TOUT","WSR")

x_pred = M_CENTRO[,selected_names]
x_pred
```

b)  Identifica columna objetivo

Para fines prácticos de esta entrega, elegiremos la variable O3 como variable dependiente. Esto se debe a la correlación moderada que tiene tanto con los contaminantes (NO,NOX,NO2) y con las variables metereológicas. Sin embargo, más adelante se planea experimentar con las variables "PM2.5" y "PM10".

```{r}
y = M_CENTRO$O3
```


### 2) Limpieza de datos

a) Elimina duplicados

```{r}
cat("Valores únicos por cada variable\n")
for (i in 1:length(selected_names)) {
cat("\n-",selected_names[i],":",length(unique(sapply(x_pred[,i],as.list)))) #Transformamos las columnas a vectores para poder calcular sus valores únicos
}

cat("\n\nNumero de observaciones totales: ",dim(x_pred)[1])
```
```{r}
x_pred =  distinct(x_pred)
cat("\n\nNumero de observaciones totales: ",dim(x_pred)[1])
```
Parace ser que no se encontraban observaciones duplicadas 

b) Corrige valores érroneos

La correción de los errores se realizaron al principio de la etapa 2, donde originalmente el tipo de dato de las observaciones de todas las variables eran de caractér.

c) Maneja valores faltantes

En base al analisis que realizamos de los valores faltantes en los puntos anteriores, vimos que no representan un porcentaje significativo en respecto con las observaciones totales, por lo que decidimos eliminarlos. Sin embargo, queda pendiente si hacer otras técnicas de sustitución de NAs mejora el rendiemiento del modelo multivariado-tal y como sustituirlos por la media de cada variable.

d) Maneja datos categóricos: Transforma a datos numéricos si es necesario.

Por el momento, decidimos no incluir la variable de las fechas en nuestro análisis.Todavía no descartamos el potencial que pudiera representar esta variable para realizar un análisis de temporalidad o épocas del año. 

e) Maneja adecuadamente los valores atípicos (outliers) que encuentres en el dataset.

Ahora, trataremos de detectar los outliers o valores atípicos dentro de los datos de la estación central (M_CENTRO) calculando los rangos intercuartílicos (IQR) de cada variable.


```{r}
#Detección de datos atípicos al calcular los límites de los valores atípicos utilizando IQR


outliersTest1 = grubbs.test(x_pred$NO)
outliersTest2 = grubbs.test(x_pred$NO2)
outliersTest3 = grubbs.test(x_pred$NOX)
outliersTest4 = grubbs.test(x_pred$RH)
outliersTest5 = grubbs.test(x_pred$SR)
outliersTest6 = grubbs.test(x_pred$TOUT)
outliersTest7 = grubbs.test(x_pred$WSR)

outliersTest1

```
El test de Grubbs resulta útil para detectar valores atípicos univariados, pero una de las desventajas es que nomás detecta uno al correr la función, por lo que se necesitaría hacer un correrse dentro de un ciclo para encontrarlos- si es que hay más de uno.

### Transformación de Datos

a) Revisa si es necesario discretizar los datos (binning)


b) Si es necesario escala y normaliza los datos.

```{r}
scaled_X =scale(x_pred)
scaled_X[1:10,]
cat("\n")
```


c) Construye atributos si es conveniente (atributos derivados).


**Referencias**

[1][https://www.who.int/es/news-room/fact-sheets/detail/ambient-(outdoor)-air-quality-and-health](https://www.who.int/es/news-room/fact-sheets/detail/ambient-(outdoor)-air-quality-and-health)

[2][https://www.weather.gov/safety/airquality](https://www.weather.gov/safety/airquality)

[3][https://www.ecologistasenaccion.org/17842/que-son-las-pm25-y-como-afectan-a-nuestra-salud/](https://www.ecologistasenaccion.org/17842/que-son-las-pm25-y-como-afectan-a-nuestra-salud/)

[4][https://www.epa.gov/ground-level-ozone-pollution/ground-level-ozone-basics](https://www.epa.gov/ground-level-ozone-pollution/ground-level-ozone-basics)

[5][https://www.epa.gov/so2-pollution/sulfur-dioxide-basics](https://www.epa.gov/so2-pollution/sulfur-dioxide-basics)

[6][https://www.theatlantic.com/health/archive/2016/02/an-american-history-of-lead-poisoning/462576/](https://www.theatlantic.com/health/archive/2016/02/an-american-history-of-lead-poisoning/462576/)

[7][https://www.milenio.com/estados/calidad-del-aire-como-se-mide-y-que-es](https://www.milenio.com/estados/calidad-del-aire-como-se-mide-y-que-es)

[8][https://www.ecologiaverde.com/que-es-y-como-se-mide-la-calidad-del-aire-2423.html](https://www.ecologiaverde.com/que-es-y-como-se-mide-la-calidad-del-aire-2423.html)

[9][https://www.unep.org/es/noticias-y-reportajes/reportajes/como-se-mide-la-calidad-del-aire](https://www.unep.org/es/noticias-y-reportajes/reportajes/como-se-mide-la-calidad-del-aire)

[10][https://www.epa.gov/sites/default/files/2015-05/documents/aqm\_200608\_challenges.pdf](https://www.epa.gov/sites/default/files/2015-05/documents/aqm_200608_challenges.pdf)

[11][https://www.un.org/es/our-work/support-sustainable-development-and-climate-action](https://www.un.org/es/our-work/support-sustainable-development-and-climate-action)

[12][https://www.gob.mx/semarnat/acciones-y-programas/programas-de-gestion-para-mejorar-la-calidad-del-aire](https://www.gob.mx/semarnat/acciones-y-programas/programas-de-gestion-para-mejorar-la-calidad-del-aire)

[13][http://aire.nl.gob.mx/](http://aire.nl.gob.mx/)

[14] [https://consejocivico.org.mx/noticias/2023/03/23/aumenta-preocupacion-sobre-mala-calidad-del-aire-ciudadania-respalda-mayores-medidas/#:~:text=La%20contaminaci%C3%B3n%20del%20aire%20es,contaminaci%C3%B3n%20del%20agua%20(17.6%25)](https://consejocivico.org.mx/noticias/2023/03/23/aumenta-preocupacion-sobre-mala-calidad-del-aire-ciudadania-respalda-mayores-medidas/#:~:text=La%20contaminaci%C3%B3n%20del%20aire%20es,contaminaci%C3%B3n%20del%20agua%20(17.6%25)).
